package jsptk;

import org.testng.Assert;
import org.testng.annotations.Test;

public class JSPTKWrapperTest {

    @Test
    public void testFreqt() {
        double[] mgc = {-2.30212, -2.73331e-05, -2.81702e-05, -3.67997e-05, -4.98102e-05,
        -1.27355e-06, 3.41756e-05, 9.0472e-06, -1.74657e-05, 2.11929e-06, 1.40704e-06, 1.72228e-05,
        4.07557e-06, -1.9592e-06, -2.8332e-05, -4.87512e-05, 7.15282e-06, -7.79278e-06, 1.97421e-05,
        4.07432e-05, -4.0155e-05, -8.33405e-05, 1.1321e-05, 4.97472e-05, 1.79e-06, 1.37316e-05,
        -4.78433e-06, 5.22122e-06, 3.18046e-06, 4.45035e-05, 2.31662e-05, -2.47332e-05,
        -2.91702e-05, 3.1306e-05, 6.2962e-05, 2.24697e-05, 9.99047e-06, -6.7129e-06, -4.7683e-05,
        -3.53126e-05, 3.16376e-05, 2.71972e-05, 1.91524e-05, -9.57541e-06, -4.02445e-05,
        -1.20303e-05, 2.65319e-05, -9.41738e-06, 1.79138e-05, -2.95782e-05};

        double[] ref = {-2.30215333e+00, -8.02592376e-05, -2.19459236e-05, 3.07451836e-05,
        -1.55502156e-05, -4.74177967e-05, -5.77070128e-06, -4.71968259e-06, 3.62168310e-05,
        4.55199240e-05, 1.95063456e-05, 5.09258894e-05, -2.29618022e-05, -2.45048821e-05,
        1.35075811e-05, -3.03614901e-05, -9.71889627e-06, 3.45965614e-05, -1.57498463e-05,
        -2.48126240e-05, 4.00203449e-05, -9.57365169e-06, -2.18354187e-05, 1.93146903e-05,
        -5.50202846e-06, 6.01164112e-06, -8.25138742e-06, -6.43327089e-06, 2.63429322e-05,
        -2.37957561e-05, -7.28094131e-06, 4.05820086e-05, -4.35088068e-05, 1.00613310e-05,
        3.26158452e-05, -4.90843786e-05, 2.71339795e-05, 1.31818005e-05, -3.92844115e-05,
        3.43785276e-05, -8.88124923e-06, -1.23853391e-05, 1.28020313e-05, 3.88519904e-06,
        -1.98971607e-05, 1.98584977e-05, -2.58679188e-06, -1.99471801e-05, 3.32390539e-05,
        -3.07735362e-05, 1.69417557e-05, -1.92139614e-06, -6.20699796e-06, 6.15191384e-06,
        -2.49242057e-06, 1.03075706e-06, -4.32156674e-06, 1.02931309e-05, -1.42594102e-05,
        1.24189226e-05, -4.39560276e-06, -6.57987631e-06, 1.56113673e-05, -1.88067075e-05,
        1.51353692e-05, -6.64255895e-06, -2.82259565e-06, 9.50904374e-06, -1.13115360e-05,
        8.34544945e-06, -2.49701335e-06, -3.64560904e-06, 7.90535817e-06, -9.21714756e-06,
        7.74082277e-06, -4.49114519e-06, 7.53683358e-07, 2.43264910e-06, -4.54870226e-06,
        5.59080198e-06, -5.87329620e-06, 5.77364004e-06, -5.53978534e-06, 5.22131070e-06,
        -4.71923999e-06, 3.90256902e-06, -2.72479976e-06, 1.28844784e-06, 1.63347807e-07,
        -1.31680731e-06, 1.88643239e-06, -1.70474595e-06, 7.73452669e-07, 7.36495827e-07,
        -2.53068491e-06, 4.26479089e-06, -5.62280751e-06, 6.37945097e-06, -6.43405350e-06,
        5.81289786e-06, -4.64535126e-06, 3.12434055e-06, -1.46305842e-06, -1.42129195e-07,
        1.53649765e-06, -2.61781019e-06, 3.33515733e-06, -3.67994095e-06, 3.67372011e-06,
        -3.35686402e-06, 2.78039753e-06, -2.00168268e-06, 1.08314998e-06, -9.24714265e-08,
        -8.97580014e-07, 1.81092327e-06, -2.57220261e-06, 3.11282172e-06, -3.37805673e-06,
        3.33393655e-06, -2.97253084e-06, 2.31454835e-06, -1.40862641e-06, 3.27263805e-07,
        8.40105065e-07, -1.99597568e-06, 3.04441886e-06, -3.90030533e-06, 4.49704688e-06,
        -4.79206491e-06, 4.76954616e-06, -4.44041062e-06, 3.83974484e-06, -3.02220830e-06,
        2.05607900e-06, -1.01666418e-06, -2.02290562e-08, 9.84170279e-07, -1.81488528e-06,
        2.46566516e-06, -2.90530123e-06, 3.11859296e-06, -3.10559590e-06, 2.87985903e-06,
        -2.46594530e-06, 1.89653819e-06, -1.20941802e-06, 4.44550933e-07, 3.58519479e-07,
        -1.16284677e-06, 1.93574877e-06, -2.64994530e-06, 3.28418729e-06, -3.82343019e-06,
        4.25862591e-06, -4.58621851e-06, 4.80743150e-06, -4.92742983e-06, 4.95443060e-06,
        -4.89882381e-06, 4.77235071e-06, -4.58737340e-06, 4.35625650e-06, -4.09087025e-06,
        3.80221532e-06, -3.50016252e-06, 3.19329568e-06, -2.88884283e-06, 2.59267956e-06,
        -2.30938826e-06, 2.04235788e-06, -1.79391025e-06, 1.56544125e-06, -1.35756696e-06,
        1.17026713e-06, -1.00302052e-06, 8.54928014e-07, -7.24821513e-07, 6.11357245e-07,
        -5.13093668e-07, 4.28554483e-07, -3.56277972e-07, 2.94854099e-07, -2.42951020e-07,
        1.99332643e-07, -1.62868849e-07, 1.32539868e-07, -1.07436144e-07, 8.67548565e-08,
        -6.97940930e-08, 5.59454820e-08, -4.46859505e-08, 3.55691138e-08, -2.82166851e-08,
        2.23101861e-08, -1.75831473e-08, 1.38139193e-08, -1.08191599e-08, 8.44801709e-09,
        -6.57700043e-09, 5.10550853e-09, -3.95196819e-09, 3.05053156e-09, -2.34827386e-09,
        1.80283421e-09, -1.38044333e-09, 1.05428570e-09, -8.03147823e-10, 6.10309241e-10,
        -4.62637587e-10, 3.49854142e-10, -2.63940675e-10, 1.98662705e-10, -1.49188066e-10,
        1.11783076e-10, -8.35715181e-11, 6.23442462e-11, -4.64093482e-11, 3.44746844e-11,
        -2.55561370e-11, 1.89061959e-11, -1.39585634e-11, 1.02853282e-11, -7.56396215e-12,
        5.55196694e-12, -4.06745715e-12, 2.97433340e-12, -2.17099347e-12, 1.58176143e-12,
        -1.15039808e-12, 8.35200743e-13, -6.05312648e-13, 4.37950607e-13, -3.16327641e-13,
        2.28100201e-13, -1.64210295e-13, 1.18024111e-13, -8.46927020e-14, 6.06785487e-14,
        -4.34057419e-14, 3.10020673e-14, -2.21092539e-14, 1.57436633e-14, -1.11942219e-14,
        7.94779060e-15, -5.63470424e-15, 3.98910708e-15, -2.82012027e-15, 1.99092220e-15,
        -1.40359848e-15, 9.88190118e-16, -6.94790832e-16, 4.87854615e-16, -3.42102463e-16,
        2.39584097e-16, -1.67572292e-16, 1.17056406e-16, -8.16663445e-17, 5.69052179e-17,
        -3.96030004e-17, 2.75281476e-17, -1.91119304e-17, 1.32530690e-17, -9.17948403e-18,
        6.35061034e-18, -4.38847294e-18, 3.02912669e-18, -2.08849145e-18, 1.43834918e-18,
        -9.89503545e-19, 6.79980902e-19, -4.66774666e-19, 3.20076526e-19, -2.19250738e-19,
        1.50028451e-19, -1.02554818e-19, 7.00314108e-20, -4.77736542e-20, 3.25572093e-20,
        -2.21652831e-20, 1.50754751e-20, -1.02434085e-20, 6.95340967e-21, -4.71557880e-21,
        3.19492024e-21, -2.16260280e-21, 1.46247709e-21, -9.88099629e-22, 6.66984110e-22,
        -4.49818178e-22, 3.03088111e-22, -2.04039738e-22, 1.37239171e-22, -9.22279085e-23,
        6.19257103e-23, -4.15439098e-23, 2.78467679e-23, -1.86499023e-23, 1.24800375e-23,
        -8.34441659e-24, 5.57468025e-24, -3.72126798e-24, 2.48205834e-24, -1.65419270e-24,
        1.10158057e-24, -7.33002438e-25, 4.87367379e-25, -3.23796567e-25, 2.14958978e-25,
        -1.42596638e-25, 9.45226930e-26, -6.26092782e-26, 4.14400049e-26, -2.74082957e-26,
        1.81145691e-26, -1.19635565e-26, 7.89553322e-27, -5.20707700e-27, 3.43162949e-27,
        -2.25997215e-27, 1.48732031e-27, -9.78153570e-28, 6.42855040e-28, -4.22206454e-28,
        2.77105273e-28, -1.81750282e-28, 1.19129146e-28, -7.80325526e-29, 5.10799712e-29,
        -3.34152478e-29, 2.18454041e-29, -1.42724638e-29, 9.31887279e-30, -6.08072617e-30,
        3.96531036e-30, -2.58422675e-30, 1.68313032e-30, -1.09557101e-30, 7.12690450e-31,
        -4.63341171e-31, 3.01052541e-31, -1.95491123e-31, 1.26869429e-31, -8.22875212e-32,
        5.33408390e-32, -3.45570274e-32, 2.23751197e-32, -1.44793337e-32, 9.36456801e-33,
        -6.05319420e-33, 3.91057717e-33, -2.52498147e-33, 1.62943966e-33, -1.05095173e-33,
        6.77475037e-34, -4.36487164e-34, 2.81072858e-34, -1.80899421e-34, 1.16366466e-34,
        -7.48156523e-35, 4.80764699e-35, -3.08780365e-35, 1.98219002e-35, -1.27180604e-35,
        8.15601359e-36, -5.22778735e-36, 3.34920895e-36, -2.14462990e-36, 1.37261792e-36,
        -8.78082987e-37, 5.61450455e-37, -3.58821666e-37, 2.29212648e-37, -1.46349938e-37,
        9.33989258e-38, -5.95782727e-38, 3.79867314e-38, -2.42089095e-38, 1.54212326e-38,
        -9.81894374e-39, 6.24904332e-39, -3.97526987e-39, 2.52769837e-39, -1.60653667e-39,
        1.02061985e-39, -6.48106743e-40, 4.11376442e-40, -2.61001988e-40, 1.65523969e-40,
        -1.04928097e-40, 6.64871424e-41, -4.21113956e-41, 2.66611462e-41, -1.68723788e-41,
        1.06731653e-41, -6.74886373e-42, 4.26569366e-42, -2.69507786e-42, 1.70206709e-42,
        -1.07450091e-42, 6.78051517e-43, -4.27706073e-43, 2.69684497e-43, -1.69979050e-43,
        1.07093883e-43, -6.74473325e-44, 4.24616357e-44, -2.67215388e-44, 1.68097006e-44,
        -1.05704437e-44, 6.64449743e-45, -4.17510762e-45, 2.62247141e-45, -1.64661598e-45,
        1.03350666e-45, -6.48447080e-46, 4.06702647e-46, -2.54989065e-46, 1.59811892e-46,
        -1.00124530e-46, 6.27070859e-47, -3.92589193e-47, 2.45700767e-47, -1.53717029e-47,
        9.61358988e-48, -6.01032803e-48, 3.75630252e-48, -2.34678644e-48, 1.46567614e-48,
        -9.15070820e-49, 5.71116150e-49, -3.56326411e-49, 2.22242038e-49, -1.38567001e-49,
        8.63673516e-50, -5.38141317e-50, 3.35197510e-50, -2.08719823e-50, 1.29922937e-50,
        -8.08477468e-51, 5.02933669e-51, -3.12762684e-51, 1.94438073e-51, -1.20839957e-51,
        7.50763942e-52, -4.66294777e-52, 2.89522753e-52, -1.79709298e-52, 1.11512818e-52,
        -6.91745135e-53, 4.28978176e-53, -2.65945546e-53, 1.64823584e-53, -1.02121165e-53,
        6.32532145e-54, -3.91670203e-54, 2.42454477e-54, -1.50041801e-54, 9.28255130e-55,
        -5.74111321e-55, 3.54976136e-55, -2.19420462e-55, 1.35590928e-55, -8.37645581e-56,
        5.17328900e-56, -3.19411507e-56, 1.97157070e-56, -1.21661379e-56, 7.50537309e-57,
        -4.62883394e-57, 2.85398223e-57, -1.75918640e-57, 1.08406159e-57, -6.67848781e-58,
        4.11324865e-58, -2.53264898e-58, 1.55900967e-58, -9.59415974e-59, 5.90268979e-59,
        -3.63059999e-59, 2.23250693e-59, -1.37244118e-59, 8.43493442e-60, -5.18271421e-60,
        3.18361778e-60, -1.95511908e-60, 1.20036869e-60, -7.36793486e-61, 4.52133911e-61,
        -2.77382514e-61, 1.70130540e-61, -1.04322308e-61, 6.39534969e-62, -3.91962127e-62,
        2.40169088e-62, -1.47124092e-62, 9.01041194e-63, -5.51696399e-63, 3.37715335e-63,
        -2.06679317e-63, 1.26455968e-63, -7.73531834e-64, 4.73057644e-64, -2.89232714e-64,
        1.76798549e-64, -1.08045920e-64, 6.60141279e-65, -4.03241021e-65, 2.46259087e-65,
        -1.50355739e-65, 9.17800702e-66, -5.60115806e-66};

        double[] test = JSPTKWrapper.freqt(mgc, 511, 0.55);
        Assert.assertEquals(test.length, ref.length);
        for (int i = 0; i<test.length; i++) {

            Assert.assertEquals(ref[i], test[i], 0.000001);
        }
    }

}
